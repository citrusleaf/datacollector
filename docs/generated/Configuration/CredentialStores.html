
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        
      <meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Credential Stores" /><meta name="abstract" content="Data Collector pipeline stages communicate with external systems to read and write data. Many of these external systems require credentials - user names or passwords - to access the data. When you configure pipeline stages for these external systems, you define the credentials that the stage uses to connect to the system." /><meta name="description" content="Data Collector pipeline stages communicate with external systems to read and write data. Many of these external systems require credentials - user names or passwords - to access the data. When you configure pipeline stages for these external systems, you define the credentials that the stage uses to connect to the system." /><meta name="DC.Relation" scheme="URI" content="../Configuration/Config_title.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="concept_bt1_bpj_r1b" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Credential Stores</title><!--  Generated with Oxygen version 18.1, build number 2016112217.  --><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/skins/skin.css" /><link rel="stylesheet" type="text/css" href="../skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../index.html";
            
            --></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script>
<!--
    Copyright 2017 StreamSets Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
</head>
<body onload="highlightSearchTerm()" class="frmBody">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../Configuration/Config_title.html" title="Configuration">Configuration</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../Configuration/Config_title.html" title="Configuration"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Configuration</span></a></span>  </span></td></tr></tbody></table>
<div class="nested0" id="concept_bt1_bpj_r1b">
 <h1 class="title topictitle1">Credential Stores</h1>

 
 <div class="body conbody"><p class="shortdesc"><span class="ph">Data
                  Collector</span>
        pipeline stages communicate with external systems to read and write data. Many of these
        external systems require credentials - user names or passwords - to access the data. When
        you configure pipeline stages for these external systems, you define the credentials that
        the stage uses to connect to the system.</p>

        <p class="p">If
            you enter credential values directly in stage properties, you expose the credentials to
            any user with access to the pipeline. To access external systems without exposing the
            credentials, define credentials in a credential store and then use the <span class="ph">Data
                  Collector</span>
            <a class="xref" href="../Expression_Language/Functions.html#concept_yvc_3qs_r1b">credential functions</a> in the stage properties to retrieve those values. </p>

     <div class="p">At this time, the following JDBC stages can use the credential functions:<ul class="ul" id="concept_bt1_bpj_r1b__d4575e61">
         <li class="li">JDBC Multitable Consumer origin</li>

         <li class="li">JDBC Query Consumer origin</li>

         <li class="li">Oracle CDC Client origin</li>

                <li class="li">SQL Server CDC Client origin</li>

         <li class="li">SQL Server Change Tracking origin</li>

         <li class="li">JDBC Lookup processor</li>

         <li class="li">JDBC Tee processor</li>

         <li class="li">JDBC Producer destination</li>

         <li class="li">JDBC Query executor</li>

     </ul>
</div>

     
        <div class="p"><span class="ph">Data
                  Collector</span> has
            a credential store API that integrates with the following credential store systems:<ul class="ul" id="concept_bt1_bpj_r1b__ul_sgq_wqs_51b">
                <li class="li"><a class="xref" href="CredentialStores.html#concept_b3c_m2n_r1b" title="To use the Java keystore credential store system, install the Java keystore credential store stage library and define the configuration properties used to connect to the credential store.">Java keystore</a>
                    - Securely store credentials in a Java keystore file.</li>

                <li class="li"><a class="xref" href="CredentialStores.html#concept_s3y_dps_51b" title="By default, a full Data Collector installation includes the Vault keystore credential store stage library. The core installation does not include the library.Use the credential:get() or credential:getWithOptions() function in pipeline stage properties to retrieve credential values from Vault.">Hashicorp
                        Vault</a> - Securely store credentials in Vault.</li>

            </ul>
</div>

        <p class="p">You can configure a <span class="ph">Data
                  Collector</span> to
            use multiple credential stores at the same time. Each credential store is identified by
            a unique ID.</p>

            <div class="note tip"><span class="tiptitle">Tip:</span> When you define credentials in a credential store instead of directly
                in stage properties, you also make it easier to migrate pipelines to another
                environment. For example, if you migrate multiple pipelines from a development to a
                production environment, you do not need to edit each pipeline to define the correct
                credentials for the production environment. You can simply replace the development
                credentials store with the production version.</div>

 </div>

<div class="related-links"></div>
<div class="topic concept nested1" id="concept_g53_vdn_r1b">
 <h2 class="title topictitle2">Group Access to Credentials</h2>

    
 <div class="body conbody"><p class="shortdesc">When you use credential functions in a pipeline, you can further secure the
        credential values by allowing only a specific group the ability to validate, preview, or run
        the pipeline.</p>

        <p class="p">The credential functions include a group argument that defines the group that can access
            the credential. Only users that have execute permission on the pipeline and that belong
            to this group can validate, preview, or run the pipeline that retrieves the credential
            values. </p>

        <p class="p">If you do not want to restrict access to the credentials, specify the default "all" group
            so that all users with execute permission on the pipeline can validate, preview, or run
            the pipeline that retrieves the credential values.</p>

        <div class="note note"><span class="notetitle">Note:</span> If <span class="ph">Data
                  Collector</span> shuts down while running a pipeline that uses a credential function, <span class="ph">Data
                  Collector</span>
            restarts the pipeline without checking the group access.</div>

 </div>

</div>
<div class="topic concept nested1" id="concept_b3c_m2n_r1b">
 <h2 class="title topictitle2">Java Keystore Credential Store</h2>

    
 <div class="body conbody"><p class="shortdesc">To use the Java keystore credential store system, install the Java keystore
        credential store stage library and define the configuration properties used to connect to
        the credential store. </p>

        <p class="p">Use the <samp class="ph codeph">jks-cs</samp> command to add
            credentials to the credential store. Then, use credential functions in pipeline stage
            properties to retrieve the credential values.</p>

    </div>

<div class="topic concept nested2" id="concept_ktc_kwk_r1b">
 <h3 class="title topictitle3">Step 1. Install the Credential Store Stage Library</h3>

 
 <div class="body conbody"><p class="shortdesc">By default, a full <span class="ph">Data
                  Collector</span>
        installation includes the Java keystore credential store stage library. The core
        installation does not include the library.</p>

        <p class="p">To verify that a <span class="ph">Data
                  Collector</span>
            has the Java keystore credential store stage library installed, click the Package
            Manager icon (<img class="image" id="concept_ktc_kwk_r1b__image_hgv_t1q_rx" src="../Graphics/icon_PackageManager.png" height="13" width="16" />) to display the list of installed stage libraries. If the
            library is not installed, <a class="xref" href="../Installation/AddtionalStageLibs.html#concept_fb2_qmn_bz" title="Install additional stage libraries to use stages that are not included in the core installation of Data Collector. This is an optional step, but generally you'll want to install additional libraries to process data after completing a core installation.">install the
                library</a> before configuring the Java keystore credential store.</p>

 </div>

</div>
<div class="topic concept nested2" id="concept_cg5_51l_r1b">
 <h3 class="title topictitle3">Step 2. Configure the Credential Store Properties</h3>

 <div class="body conbody">
        <p class="p">To enable <span class="ph">Data
                  Collector</span> to
            connect to the Java keystore credential store, configure the Java keystore properties in
            the <samp class="ph codeph">$SDC_CONF/credential-stores.properties</samp> file.</p>

        <div class="note important"><span class="importanttitle">Important:</span> 
            <span class="ph">For a Cloudera Manager installation, configure all credential store properties through
         Cloudera Manager. In Cloudera Manager, select the StreamSets service and then click
         Configuration. Add a line for each credential store property that you need to configure to the Data Collector Advanced Configuration
         Snippet (Safety Valve) for sdc.properties field as follows:</span><pre class="pre codeblock">credentialStores=jks</pre>
</div>

        <ol class="ol" id="concept_cg5_51l_r1b__ol_trs_xcl_r1b">
            <li class="li">Uncomment the <samp class="ph codeph">credentialStores</samp> property in the file.<p class="p">If enabling
                    the only the Java keystore credential store, set the property to "jks". If
                    enabling both the Java keystore and the Vault credential stores, leave the
                    default value of "jks,vault".</p>
</li>

            <li class="li">Configure the following properties in the Java Keystore Credential Store section of
                the file:
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="concept_cg5_51l_r1b__table_spl_ycl_r1b" class="table" frame="border" border="1" rules="all">
                        
                        
                        <thead class="thead" align="left">
                            <tr>
                                <th class="entry" valign="top" width="46%" id="d38160e279">Java Keystore Property</th>

                                <th class="entry" valign="top" width="54%" id="d38160e282">Description</th>

                            </tr>

                        </thead>

                        <tbody class="tbody">
                            <tr>
                                <td class="entry" valign="top" width="46%" headers="d38160e279 ">credentialStore.jks.config.keystore.type</td>

                                <td class="entry" valign="top" width="54%" headers="d38160e282 ">Format of the Java keystore file:<ul class="ul" id="concept_cg5_51l_r1b__ul_tpl_ycl_r1b">
                                        <li class="li">JCEKS</li>

                                        <li class="li">PKCS12</li>

                                    </ul>
<p class="p">Default is PKCS12.</p>
</td>

                            </tr>

                            <tr>
                                <td class="entry" valign="top" width="46%" headers="d38160e279 ">credentialStore.jks.config.keystore.file</td>

                                <td class="entry" valign="top" width="54%" headers="d38160e282 ">Path and name of the Java keystore file. Enter an absolute
                                    path to the file, or a path relative to the <span class="ph">Data
                  Collector</span> configuration directory,
                                        <samp class="ph codeph">$SDC_CONF</samp>.<p class="p">Default is
                                            <samp class="ph codeph">jks-credentialStore.pkcs12</samp>.</p>
</td>

                            </tr>

                            <tr>
                                <td class="entry" valign="top" width="46%" headers="d38160e279 ">credentialStore.jks.config.keystore.storePassword</td>

                                <td class="entry" valign="top" width="54%" headers="d38160e282 ">Password that <span class="ph">Data
                  Collector</span> uses to access the Java keystore file. <p class="p">You must change the
                                        default value before using the keystore file.</p>
</td>

                            </tr>

                        </tbody>

                    </table>
</div>
</li>

            <li class="li">Restart <span class="ph">Data
                  Collector</span> to enable the changes.</li>

        </ol>

 </div>

</div>
<div class="topic concept nested2" id="concept_lbj_zwl_r1b">
 <h3 class="title topictitle3">Step 3. Add Credentials to the Credential Store</h3>

 
 <div class="body conbody"><p class="shortdesc">Use the <samp class="ph codeph">jks-cs add</samp> command to add credentials to the Java keystore
        file. You can add multiple credentials to the file.</p>

  <div class="p">Use the command as
            follows:<pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs add -i &lt;storeId&gt; -n &lt;credential name&gt; -c &lt;credential value&gt;</pre>
</div>

        <div class="p">For example, the following command adds a credential named
            OracleDBPassword with the value 278yT6!u to the Java keystore credential
            store:<pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs add -i jks -n OracleDBPassword -c 278yT6!u</pre>
</div>

        
        <div class="note note"><span class="notetitle">Note:</span> The jks-cs command also includes <samp class="ph codeph">delete</samp> and <samp class="ph codeph">list</samp>
            subcommands that you use to manage the credentials defined in the keystore file. For
            information on using these commands, see <a class="xref" href="CredentialStores.html#concept_ywj_2wm_r1b" title="The jks-cs command provides subcommands to add, list, and delete credentials in the Java keystore credential store.">jks-cs Command</a>. </div>

 </div>

</div>
<div class="topic concept nested2" id="concept_xmb_m5j_r1b">
 <h3 class="title topictitle3">Step 4. Call the Credentials from the Pipeline</h3>

 
 <div class="body conbody"><p class="shortdesc">Use the <samp class="ph codeph">credential:get()</samp> function in pipeline stage properties to
        retrieve  credential values from the Java keystore. </p>

            <p class="p">Use the credential function in any JDBC stage property that displays the key icon
            next to it. For example:</p>

        <p class="p"><img class="image" id="concept_xmb_m5j_r1b__image_e4w_ssx_v1b" src="../Graphics/CredentialStores_KeyIcon.png" height="224" width="696" /></p>

        
        <div class="note important"><span class="importanttitle">Important:</span> When you use a credential function in a stage
                property, the function must be the only value defined in the property. For example,
                you cannot include another function or a literal value along with the credential
                function.</div>

        <div class="p">The <samp class="ph codeph">credential:get()</samp> function uses the following arguments:<ul class="ul" id="concept_xmb_m5j_r1b__ul_l4b_bl5_51b">
                <li class="li">storeId - Unique ID of the credential store to use. Enter "jks" to access the
                    Java keystore credential store.</li>

                <li class="li">group - Group to which a user must belong before that user can access the
                credential. Only users that have execute permission on the pipeline and that belong
                to this group can validate, preview, or run the pipeline that retrieves the
                credential values. If you specify the default "all" group, then all users with
                execute permission on the pipeline can validate, preview, or run the pipeline that
                retrieves the credential values.</li>

                <li class="li">credential name - Name of the credential value to retrieve from the credential
                    store.</li>

            </ul>
</div>

        <div class="p">For example, the following expression returns the value of
            the OracleDBPassword credential and allows any user belonging to the devops group access
            to the credential when validating, previewing, or running the
            pipeline:<pre class="pre codeblock">${credential:get("jks", "devops", "OracleDBPassword")}</pre>
</div>

 </div>

    <div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../Expression_Language/Functions.html#concept_yvc_3qs_r1b" title="Credential Functions">Credential Functions</a></div>
</div>
</div>
</div>
<div class="topic concept nested2" id="concept_ywj_2wm_r1b">
 <h3 class="title topictitle3">jks-cs Command</h3>

 
 <div class="body conbody"><p class="shortdesc">The <samp class="ph codeph">jks-cs</samp> command provides subcommands to add, list, and delete
        credentials in the Java keystore credential store. </p>

        <p class="p">Any
            changes made to the Java keystore file take effect immediately. For example, if you
            change the value of an existing credential in the file, running pipelines that require a
            new connection to the external system use the new credential value.</p>

        <div class="p">You can use the following subcommands with the <samp class="ph codeph">jks-cs</samp> command:<dl class="dl">
                
                    <dt class="dt dlterm">add</dt>

                    <dd class="dd">Adds a credential to the Java keystore credential store.</dd>

                    <dd class="dd">Use the command as follows:</dd>

                    <dd class="dd">
                        <pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs add \
(-i &lt;storeId&gt; | --id &lt;storeId&gt;) \
(-n &lt;credential name&gt; | --name &lt;credential name&gt;) \
(-c &lt;credential value&gt; | --credential &lt;credential value&gt;)</pre>

                    </dd>

                    <dd class="dd">
                        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="concept_ywj_2wm_r1b__table_i4m_vjr_yt" class="table" frame="border" border="1" rules="all">
                                
                                
                                <thead class="thead" align="left">
                                    <tr>
                                        <th class="entry" valign="top" width="30%" id="d38160e517">Add Option</th>

                                        <th class="entry" valign="top" width="70%" id="d38160e520">Description</th>

                                    </tr>

                                </thead>

                                <tbody class="tbody">
                                    <tr>
                                        <td class="entry" valign="top" width="30%" headers="d38160e517 ">-i &lt;storeId&gt;<p class="p">or </p>
<p class="p">--id
                                            &lt;storeId&gt;</p>
</td>

                                        <td class="entry" valign="top" width="70%" headers="d38160e520 ">Required. Unique ID for the credential store. Use
                                            jks.</td>

                                    </tr>

                                    <tr>
                                        <td class="entry" valign="top" width="30%" headers="d38160e517 ">-n &lt;credential name&gt;<p class="p">or</p>
<p class="p">--name
                                                &lt;credential name&gt;</p>
</td>

                                        <td class="entry" valign="top" width="70%" headers="d38160e520 ">Required. Name of the credential to add to the Java
                                            keystore credential store.</td>

                                    </tr>

                                    <tr>
                                        <td class="entry" valign="top" width="30%" headers="d38160e517 ">-c &lt;credential value&gt;<p class="p">or</p>
<p class="p">--credential
                                                &lt;credential value&gt;</p>
</td>

                                        <td class="entry" valign="top" width="70%" headers="d38160e520 ">Required. Value of the credential to add to the Java
                                            keystore credential store.</td>

                                    </tr>

                                </tbody>

                            </table>
</div>

                    </dd>

                    <dd class="dd">
                        <div class="p">For example, the following command adds a credential named
            OracleDBPassword with the value 278yT6!u to the Java keystore credential
            store:<pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs add -i jks -n OracleDBPassword -c 278yT6!u</pre>
</div>

                    </dd>

                
                
                    <dt class="dt dlterm">delete</dt>

                    <dd class="dd">Deletes a credential from the Java keystore credential store.</dd>

                    <dd class="dd">Use the command as follows:</dd>

                    <dd class="dd">
                        <pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs delete \
(-i &lt;storeId&gt; | --id &lt;storeId&gt;) \
(-n &lt;credential name&gt; | --name &lt;credential name&gt;)</pre>

                    </dd>

                    <dd class="dd">
                        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="concept_ywj_2wm_r1b__table_spw_wym_r1b" class="table" frame="border" border="1" rules="all">
                                
                                
                                <thead class="thead" align="left">
                                    <tr>
                                        <th class="entry" valign="top" width="30%" id="d38160e611">Delete Option</th>

                                        <th class="entry" valign="top" width="70%" id="d38160e614">Description</th>

                                    </tr>

                                </thead>

                                <tbody class="tbody">
                                    <tr>
                                        <td class="entry" valign="top" width="30%" headers="d38160e611 ">-i &lt;storeId&gt;<p class="p">or </p>
<p class="p">--id
                                            &lt;storeId&gt;</p>
</td>

                                        <td class="entry" valign="top" width="70%" headers="d38160e614 ">Required. Unique ID for the credential store. Use
                                            jks.</td>

                                    </tr>

                                    <tr>
                                        <td class="entry" valign="top" width="30%" headers="d38160e611 ">-n &lt;credential name&gt;<p class="p">or</p>
<p class="p">--name
                                                &lt;credential name&gt;</p>
</td>

                                        <td class="entry" valign="top" width="70%" headers="d38160e614 ">Required. Name of the credential to delete from the
                                            Java keystore credential store.</td>

                                    </tr>

                                </tbody>

                            </table>
</div>

                    </dd>

                    <dd class="dd">For example, the following command deletes a credential named
                        SQLServerDBPassword from the Java keystore credential store:
                        <pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs delete -i jks -n SQLServerDBPassword</pre>
</dd>

                
                
                    <dt class="dt dlterm">list</dt>

                    <dd class="dd">Lists the names of all credentials defined in the Java keystore credential
                        store. The command does not list the credential values.</dd>

                    <dd class="dd">Use the command as follows:</dd>

                    <dd class="dd">
                        <pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs list \
(-i &lt;storeId&gt; | --id &lt;storeId&gt;)</pre>

                    </dd>

                    <dd class="dd">
                        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="concept_ywj_2wm_r1b__table_zzy_fzm_r1b" class="table" frame="border" border="1" rules="all">
                                
                                
                                <thead class="thead" align="left">
                                    <tr>
                                        <th class="entry" valign="top" width="30%" id="d38160e689">List Option</th>

                                        <th class="entry" valign="top" width="70%" id="d38160e692">Description</th>

                                    </tr>

                                </thead>

                                <tbody class="tbody">
                                    <tr>
                                        <td class="entry" valign="top" width="30%" headers="d38160e689 ">-i &lt;storeId&gt;<p class="p">or </p>
<p class="p">--id
                                            &lt;storeId&gt;</p>
</td>

                                        <td class="entry" valign="top" width="70%" headers="d38160e692 ">Required. Unique ID for the credential store. Use
                                            jks.</td>

                                    </tr>

                                </tbody>

                            </table>
</div>

                    </dd>

                    <dd class="dd">For example, the following command lists the names of all credentials
                        defined in the Java keystore credential store:
                        <pre class="pre codeblock">$SDC_DIST/bin/streamsets jks-cs list -i jks</pre>
</dd>

                
            </dl>
</div>

    </div>

</div>
</div>
<div class="topic concept nested1" id="concept_s3y_dps_51b">
 <h2 class="title topictitle2">Vault Credential Store</h2>

 <div class="body conbody">
  <p class="p">To use the Vault credential
            store system, install the Vault credential store stage library and define the
            configuration properties used to connect to Vault. Then, use credential functions in
            pipeline stage properties to retrieve the credential values.</p>

        <div class="note note"><span class="notetitle">Note:</span> This documentation includes details about Hashicorp Vault to simplify the
            configuration process. For more information, see the Vault documentation.</div>

 </div>

<div class="topic concept nested2" id="concept_kyt_lps_51b">
 <h3 class="title topictitle3">Step 1. Install the Credential Store Stage Library</h3>

 
 <div class="body conbody"><p class="shortdesc">By default, a full <span class="ph">Data
                  Collector</span>
        installation includes the Vault keystore credential store stage library. The core
        installation does not include the library.</p>

  <p class="p">To verify that a <span class="ph">Data
                  Collector</span>
            has the Vault credential store stage library installed, click the Package Manager icon
                (<img class="image" id="concept_kyt_lps_51b__image_hgv_t1q_rx" src="../Graphics/icon_PackageManager.png" height="13" width="16" />) to display the list of installed stage libraries. If the library is not installed,
                <a class="xref" href="../Installation/AddtionalStageLibs.html#concept_fb2_qmn_bz" title="Install additional stage libraries to use stages that are not included in the core installation of Data Collector. This is an optional step, but generally you'll want to install additional libraries to process data after completing a core installation.">install the
                library</a> before configuring the Vault credential store.</p>

 </div>

</div>
<div class="topic concept nested2" id="concept_bhn_4ps_51b">
 <h3 class="title topictitle3">Step 2. Configure the Credential Store Properties</h3>

 <div class="body conbody">
        <p class="p">To enable <span class="ph">Data
                  Collector</span> to
            connect to the Vault credential store, configure the Vault properties in the
                <samp class="ph codeph">$SDC_CONF/credential-stores.properties</samp> file.</p>

        <div class="note important"><span class="importanttitle">Important:</span> 
            <span class="ph">For a Cloudera Manager installation, configure all credential store properties through
         Cloudera Manager. In Cloudera Manager, select the StreamSets service and then click
         Configuration. Add a line for each credential store property that you need to configure to the Data Collector Advanced Configuration
         Snippet (Safety Valve) for sdc.properties field as follows:</span><pre class="pre codeblock">credentialStores=vault</pre>
</div>

        <ol class="ol">
            <li class="li">Uncomment the <samp class="ph codeph">credentialStores</samp> property in the file.<p class="p">If enabling
                    the only the Vault credential store, set the property to "vault". If enabling
                    both the Java keystore and the Vault credential stores, leave the default value
                    of "jks,vault".</p>
</li>

            <li class="li">Configure the following properties in the Hashicorp Vault Credential Store section
                of the file. <p class="p">The Vault server URL, Role ID, and Secret ID are required
                    properties. Configure other properties as needed:</p>
<div class="p">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="concept_bhn_4ps_51b__table_yjv_42v_51b" class="table" frame="border" border="1" rules="all">
    
    
    <thead class="thead" align="left">
     <tr>
      <th class="entry" valign="top" width="46%" id="d38160e856">Vault Property</th>

      <th class="entry" valign="top" width="54%" id="d38160e859">Description</th>

     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.pathKey.separator</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Separator to use for the path and key values in the credential name argument
       used by the <a class="xref" href="../Expression_Language/Functions.html#concept_yvc_3qs_r1b">credential functions</a>.<div class="p">You use the following format for the name
        argument:<pre class="pre codeblock">&lt;path&gt;&lt;separator&gt;&lt;key&gt;</pre>
</div>
<div class="p">For example, if you
        keep the default of &amp;, the format for the name argument
        is:<pre class="pre codeblock">&lt;path&gt;&amp;&lt;key&gt;</pre>
</div>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4701">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.addr</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Required. Vault server URL entered in the following
        format:<pre class="pre codeblock">https://&lt;host name&gt;:&lt;port number&gt;</pre>
<p class="p">Use HTTPS to avoid
        unencrypted communication.</p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4714">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.role.id</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Required. Vault Role ID that <span class="ph">Data
                  Collector</span> uses to
       authenticate with Vault. The Role ID is configured within Vault by your Vault administrator.
        <div class="p">The <span class="ph">Data
                  Collector</span>
        Vault integration relies on Vault's App Role authentication backend.<div class="note important"><span class="importanttitle">Important:</span> The App ID authentication backend has been deprecated by Hashicorp and will be removed in
         a future release. As a result, do not configure the
          <samp class="ph codeph">credentialStore.vault.config.app.id</samp> property for new
         installations.</div>
</div>
</td>

     </tr>

      <tr id="concept_bhn_4ps_51b__d4425e4734">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.secret.id</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Required. Vault Secret ID that <span class="ph">Data
                  Collector</span> uses to
       authenticate with Vault. The Secret ID is configured within Vault by your Vault
       administrator. <div class="p">Enter one of the following:<ul class="ul" id="concept_bhn_4ps_51b__d4425e4745">
         <li class="li">Secret ID value.</li>

         <li class="li">File that contains the Secret ID value. For increased security, store the Secret ID in
          a separate file and reference the file in the
           <samp class="ph codeph">$SDC_CONF/credential-stores.properties</samp> file as follows:
          ${file("&lt;filename&gt;")}. <p class="p">By default, the file name is <samp class="ph codeph">vault-secret-id</samp>
           and expected in the <samp class="ph systemoutput">$SDC_CONF</samp> directory. For more
           information, see <a class="xref" href="DCConfig.html#concept_aqc_dbt_zr" title="For increased security you can store sensitive information, such as a password, in separate files and reference the files in the Data Collector configuration file, $SDC_CONF/sdc.properties, as follows: ${file(&#34;&lt;filename&gt;&#34;)}.">Referencing Sensitive Values in Files</a>.</p>
</li>

        </ul>
</div>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4768">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.lease.renewal.interval.sec</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Seconds to wait before checking for leases that need renewal. <p class="p">Default is
        60. </p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4780">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.lease.expiration.buffer.sec</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Buffer for expiring leases. <span class="ph">Data
                  Collector</span> renews
       leases that expire in less than the specified number of seconds.<p class="p">Default is 120.
       </p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4793">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.open.timeout</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Timeout to establish an HTTP connection to Vault in milliseconds. <p class="p">Default
        is 0 for no limit. </p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4804">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.proxy.address</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Proxy URL. Configure to use a proxy to access Vault. </td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4813">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.proxy.port</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Proxy port. Configure to use a proxy to access Vault. </td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4822">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.proxy.username</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Proxy username. Configure to use a proxy to access Vault. </td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4831">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.proxy.password</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Proxy password. Configure to use a proxy to access Vault. </td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4841">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.read.timeout</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Milliseconds to wait for data before timing out. <p class="p">Default is 0 for no
        limit. </p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4852">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.ssl.enabled.protocols</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. SSL/TLS-enabled protocols. Versions TLSv1.2 or later are
        recommended.<p class="p">Default is TLSv1.2,TLSv1.3.</p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4863">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.ssl.truststore.file</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Path to a Java truststore file. Required when using a private CA or
       certificates not trusted by the Java default truststore. </td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4872">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.ssl.truststore.password</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Password for the truststore file. </td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4881">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.ssl.verify</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Whether to verify that the Vault server hostname matches its
        certificate.<p class="p">Default is true. False is not recommended.</p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4892">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.ssl.timeout</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Timeout for the SSL/TLS handshake in milliseconds. <p class="p">Default is 0 for no
        limit. </p>
</td>

     </tr>

     <tr id="concept_bhn_4ps_51b__d4425e4904">
      <td class="entry" valign="top" width="46%" headers="d38160e856 ">credentialStore.vault.config.timeout</td>

      <td class="entry" valign="top" width="54%" headers="d38160e859 ">Optional. Timeout to read from Vault in milliseconds, after a connection has been
        established.<p class="p">Default is 0 for no limit. </p>
</td>

     </tr>

    </tbody>

   </table>
</div>

                </div>
</li>

            <li class="li">Restart <span class="ph">Data
                  Collector</span> to enable the changes.</li>

        </ol>

    </div>

</div>
<div class="topic concept nested2" id="concept_sbq_vps_51b">
 <h3 class="title topictitle3">Step 3. Call the Credentials from the Pipeline</h3>

 
 <div class="body conbody"><p class="shortdesc">Use the <samp class="ph codeph">credential:get()</samp> or
            <samp class="ph codeph">credential:getWithOptions()</samp> function in pipeline stage properties to
        retrieve credential values from Vault. </p>

        <p class="p">Use the credential functions in any JDBC stage property that displays the key icon next
            to it. For example:</p>

        <p class="p"><img class="image" id="concept_sbq_vps_51b__image_e4w_ssx_v1b" src="../Graphics/CredentialStores_KeyIcon.png" height="224" width="696" /></p>

     <div class="note important"><span class="importanttitle">Important:</span> When you use a credential function in a stage
                property, the function must be the only value defined in the property. For example,
                you cannot include another function or a literal value along with the credential
                function.</div>

        <div class="p">The credential functions use the following arguments:<ul class="ul" id="concept_sbq_vps_51b__ul_wyt_zk5_51b">
                <li class="li">storeId - Unique ID of the credential store to use. Enter "vault" to access the
                    Vault credential store.</li>

                <li class="li">group - Group to which a user must belong before that user can access the
                credential. Only users that have execute permission on the pipeline and that belong
                to this group can validate, preview, or run the pipeline that retrieves the
                credential values. If you specify the default "all" group, then all users with
                execute permission on the pipeline can validate, preview, or run the pipeline that
                retrieves the credential values.</li>

                <li class="li">credential name - Name of the credential value to retrieve from Vault. Use the
                    following format: <samp class="ph codeph">"&lt;path&gt;&lt;separator&gt;&lt;key&gt;"</samp>, where:<ul class="ul" id="concept_sbq_vps_51b__ul_rfv_3lx_v1b">
                        <li class="li"><samp class="ph codeph">&lt;path&gt;</samp> is the path in Vault to read.</li>

                        <li class="li"><samp class="ph codeph">&lt;separator&gt;</samp> is the separator defined for the path
                            and key values in the
                                <samp class="ph codeph">$SDC_CONF/credential-stores.properties</samp> file.</li>

                        <li class="li"><samp class="ph codeph">&lt;key&gt;</samp> is the key for the value that you want
                            returned.</li>

                    </ul>
</li>

                <li class="li">options - Used only by the <samp class="ph codeph">credential:getWithOptions()</samp>
                    function. Additional options to communicate with the credential store. For
                    Vault, you can enter a delay in milliseconds to allow time for external
                    processing. <p class="p">Use the following format to specify an
                        option:</p>
<pre class="pre codeblock">"&lt;option&gt;=&lt;value&gt;"</pre>
<div class="p">For example, to
                        set the Vault delay to 1,000 milliseconds, enter the following for the
                        options argument:<pre class="pre codeblock">"delay=1000"</pre>
</div>
</li>

            </ul>
</div>

        <div class="p">For example, the following expression returns the value of
            the OracleDBPassword credential stored in the Vault /databases/ path after waiting for a
            delay of 1,000 milliseconds. The credential name argument uses the default separator of
            &amp;. The expression allows any user belonging to the devops group access to the
            credential when validating, previewing, or running the
            pipeline:<pre class="pre codeblock">${credential:getwithOptions("vault", "devops", "/databases/&amp;OracleDBPassword", "delay=1000")}</pre>
</div>

 </div>

    <div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../Expression_Language/Functions.html#concept_yvc_3qs_r1b" title="Credential Functions">Credential Functions</a></div>
</div>
</div>
</div>
</div>
</div>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../Configuration/Config_title.html" title="Configuration"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Configuration</span></a></span>  </div><div class="footer" id="webhelp_copyright_information"><!--

    Copyright 2017 StreamSets Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

--><!-- SDC google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60917135-3', 'auto');
  ga('send', 'pageview');
</script></div>
</body>
</html>